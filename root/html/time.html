<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CGI - WebServ</title>

    <style>
        body {
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, sans-serif;
            background: #f5f6fa;
            margin: 0;
            padding: 0;
            color: #222;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 32px 20px;
        }

        .btn-back {
            display: inline-block;
            padding: 10px 16px;
            background: white;
            border-radius: 8px;
            border: 2px solid #4f46e5;
            color: #4f46e5;
            font-size: 0.95rem;
            text-decoration: none;
            transition: background .15s, color .15s;
            margin-bottom: 24px;
        }

        .btn-back:hover {
            background: #4f46e5;
            color: white;
        }

        .content-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }

        h2 {
            margin-top: 0;
            font-weight: 700;
            margin-bottom: 18px;
        }

        .output-box {
            background: #f0f2f7;
            padding: 20px;
            border-radius: 10px;
            margin-top: 16px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 1rem;
            color: #333;
        }

        .loading {
            color: #666;
            font-style: italic;
        }

        /* --- Minimal added styles for input at the bottom --- */
        .runner-row {
            margin-top: 16px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        .runner-row input {
            flex: 1;
            min-width: 220px;
            padding: 10px 12px;
            border-radius: 10px;
            border: 1px solid #e6e8ef;
            background: #fafbff;
            font-size: 1rem;
            outline: none;
        }

        .runner-row input:focus {
            border-color: #4f46e5;
            background: #fff;
        }

        .btn-run {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
        }

        .btn-run:hover {
            background: #4338ca;
        }

        .hint {
            margin-top: 10px;
            color: #666;
            font-size: 0.95rem;
        }

        code {
            background: #eef0ff;
            padding: 2px 6px;
            border-radius: 6px;
        }
    </style>
</head>

<body>
    <div class="container">
        <a href="index.html" class="btn-back">← Back</a>

        <div class="content-card">
            <h2 id="title">CGI Script</h2>

            <p>
                Calls <code id="pathLabel">root/cgi-bin/time.py</code> and displays the output.
            </p>

            <div id="output" class="output-box loading">
                Loading…
            </div>

            <!-- ✅ minimal new UI: filename input at the bottom -->
            <div class="runner-row">
                <input id="fileInput" type="text" value="time.py" placeholder="e.g. time.py / hello.py / post.rb">
                <button class="btn-run" onclick="runFile()">Run</button>
            </div>
        </div>
    </div>

    <script>
        const BASE = "/root/cgi-bin/";
        let currentFile = "time.py";

        function setCurrent(file) {
            // super small "sanitize": keep only last path part
            file = (file || "").trim();
            if (!file) return;

            // prevent people entering full paths
            file = file.split("/").pop();

            currentFile = file;

            document.getElementById("title").textContent = "CGI: " + currentFile;
            document.getElementById("pathLabel").textContent = BASE + currentFile;
        }

        function runFile() {
            const inp = document.getElementById("fileInput");
            setCurrent(inp.value);
            loadCGI();
        }

        function loadCGI() {
            const box = document.getElementById("output");
            box.classList.add("loading");
            box.textContent = "Loading " + currentFile + "…";

            fetch(BASE + currentFile, { cache: "no-store" })
                .then(r => r.text())
                .then(txt => {
                    box.classList.remove("loading");

                    // If you want to render HTML returned by CGI, use innerHTML:
                    box.innerHTML = txt;

                    // Safer default (no HTML execution):
                    // box.textContent = txt;
                })
                .catch(err => {
                    box.classList.remove("loading");
                    box.textContent = "Error: " + err;
                });
        }

        // init
        setCurrent(currentFile);
        loadCGI();
    </script>
</body>
</html>
